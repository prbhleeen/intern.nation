<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Payments & Subscription | intern.nation</title>
  <link rel="icon" type="image/jpeg" href="../assets/logo.jpeg" />
  <link rel="stylesheet" href="../css/Payment.css" />
  <style>
    .page-toast {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%) translateY(20px);
      background: #333;
      color: #fff;
      padding: 10px 20px;
      border-radius: 5px;
      opacity: 0;
      transition: opacity 0.4s, transform 0.4s;
      z-index: 9999;
    }
    .page-toast.visible {
      opacity: 1;
      transform: translateX(-50%) translateY(0);
    }
    .page-toast.error {
      background: #e74c3c;
    }

    .accordion-item {
      background: #f5f5f5;
      border: none;
      outline: none;
      padding: 12px 16px;
      width: 100%;
      text-align: left;
      cursor: pointer;
      font-size: 16px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 4px;
    }
    .panel {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.3s ease;
      padding: 0 16px;
      background: #fff;
      font-size: 15px;
    }
    .acc-icon {
      font-weight: bold;
      margin-left: 8px;
    }
  </style>
</head>
<body>

  <header>
    <div class="header-left">
      <img src="../assets/logo.jpeg" alt="Logo">
      <h1>intern.nation | Payments & Subscriptions</h1>
    </div>
  </header>

  <div class="dashboard-container">

    <aside class="sidebar" aria-label="Main Navigation">
      <ul id="navList">
        <li><a href="#dashboard" data-target="dashboard">üè† Dashboard Home</a></li>
        <li><a href="#overview" data-target="overview">üíº Overview</a></li>
        <li><a href="#plans" data-target="plans">üìà Subscription Plans</a></li>
        <li><a href="#status" data-target="status">üßæ Active Subscription</a></li>
        <li><a href="#history" data-target="history">üìú Payment History</a></li>
        <li><a href="#methods" data-target="methods">üí≥ Payment Methods</a></li>
        <li><a href="#faqs" data-target="faqs">‚ùì FAQs</a></li>
      </ul>
    </aside>

    <main class="main-content">

      <section id="dashboard" class="dashboard-home">
        <h2>üè† Dashboard Home</h2>
        <p style="text-align:center;margin-bottom:1rem;">Quick summary of your account and billing.</p>
        <div class="cards">
          <div class="card">
            <h3 id="card-plan">No Active Plan</h3>
            <p>Active Subscription</p>
          </div>
          <div class="card">
            <h3 id="card-next-bill">‚Äî</h3>
            <p>Next Billing</p>
          </div>
          <div class="card">
            <h3 id="card-history-count">0</h3>
            <p>Payments Recorded</p>
          </div>
          <div class="card">
            <h3 id="card-saved-cards">0</h3>
            <p>Saved Payment Methods</p>
          </div>
        </div>
      </section>

      <section id="overview">
        <h2>Payment & Subscription Overview</h2>
        <p>Manage your plans, track billing, and stay updated on your subscriptions from one dashboard.</p>
      </section>

      <section id="plans" class="plans-section">
        <div class="plans-header">
          <h2>Available Plans</h2>
          <div class="toggle-container">
            <span>Monthly</span>
            <label class="switch" aria-label="Toggle pricing period">
              <input type="checkbox" id="togglePlan">
              <span class="slider round"></span>
            </label>
            <span>Yearly <small>(Save 20%)</small></span>
          </div>
        </div>
        <div class="plans">
          <div class="plan" id="basic-plan">
            <h3>Basic</h3>
            <p class="price" id="basic-price">‚Çπ499/month</p>
            <ul>
              <li>Up to 5 job posts</li>
              <li>Basic analytics</li>
              <li>Email support</li>
            </ul>
            <button class="subscribe-btn" onclick="subscribePlan('Basic')">Subscribe</button>
          </div>
          <div class="plan pro" id="pro-plan">
            <h3>Pro</h3>
            <p class="price" id="pro-price">‚Çπ799/month</p>
            <ul>
              <li>Up to 15 job posts</li>
              <li>Priority analytics</li>
              <li>Phone & Email support</li>
              <li>Job highlights</li>
            </ul>
            <button class="subscribe-btn" onclick="subscribePlan('Pro')">Subscribe</button>
          </div>
          <div class="plan premium" id="premium-plan">
            <h3>Premium</h3>
            <p class="price" id="premium-price">‚Çπ999/month</p>
            <ul>
              <li>Unlimited job posts</li>
              <li>Advanced analytics dashboard</li>
              <li>Dedicated account manager</li>
              <li>Featured listings</li>
            </ul>
            <button class="subscribe-btn" onclick="subscribePlan('Premium')">Subscribe</button>
          </div>
        </div>
      </section>

  
      <section id="status" class="subscription-status">
        <h2>üßæ Active Subscription</h2>
        <div id="subscriptionStatus">
          <p>No active subscription found.</p>
        </div>
      </section>


      <section id="history" class="payment-history">
        <h2>üìú Payment History</h2>
        <table>
          <thead>
            <tr>
              <th>Payment ID</th>
              <th>Plan</th>
              <th>Amount</th>
              <th>Date</th>
              <th>Status</th>
            </tr>
          </thead>
          <tbody id="paymentTableBody"></tbody>
        </table>
      </section>

      <!-- PAYMENT METHODS -->
      <section id="methods" class="methods-section">
        <h2>üí≥ Payment Methods</h2>
        <div class="methods-grid">
          <div class="saved-cards">
            <h3>Saved Cards</h3>
            <ul id="savedCardsList" class="card-list"></ul>
          </div>
          <div class="add-card">
            <h3>Add a New Card</h3>
            <form id="cardForm" aria-label="Add payment method form">
              <label>
                Cardholder Name
                <input type="text" id="cardName" required />
              </label>
              <label>
                Card Number
                <input type="text" id="cardNumber" inputmode="numeric" maxlength="19" placeholder="4242 4242 4242 4242" required />
              </label>
              <div class="row">
                <label>
                  Expiry (MM/YY)
                  <input type="text" id="cardExpiry" maxlength="5" placeholder="08/26" required />
                </label>
                <label>
                  CVV
                  <input type="password" id="cardCvv" maxlength="4" inputmode="numeric" required />
                </label>
              </div>
              <button type="submit" class="subscribe-btn">Save Card</button>
            </form>
          </div>
        </div>
        <p class="muted">Note: This is a frontend demo. Card data is stored locally in the page memory only.</p>
      </section>

      <section id="faqs" class="faqs-section">
        <h2>‚ùì FAQs</h2>
        <div class="accordion">
          <button class="accordion-item" aria-expanded="false">
            How do billing cycles work? <span class="acc-icon">+</span>
          </button>
          <div class="panel">Billing occurs monthly or yearly depending on your selected plan. You will be charged at the start of each cycle.</div>

          <button class="accordion-item" aria-expanded="false">
            Can I cancel anytime? <span class="acc-icon">+</span>
          </button>
          <div class="panel">Yes. You can cancel from the Active Subscription card. Access remains until the end of the paid cycle.</div>

          <button class="accordion-item" aria-expanded="false">
            Do you offer refunds? <span class="acc-icon">+</span>
          </button>
          <div class="panel">Refunds are handled case-by-case. Please contact support@intern.nation for refund requests.</div>
        </div>
      </section>

    </main>
  </div>

  <footer role="contentinfo">
    &copy; 2025 intern.nation | All Rights Reserved
  </footer>

  <script>

    let isYearly = false;
    let paymentHistory = [
      { id: 101, plan: "Basic", amount: 499, date: "10 Oct 2025", status: "Paid" },
      { id: 102, plan: "Premium", amount: 999, date: "22 Oct 2025", status: "Pending" }
    ];
    let savedCards = [];
    let currentSubscription = null;
    const planPrices = {
      Basic: { monthly: 499, yearly: 4790 },
      Pro: { monthly: 799, yearly: 7670 },
      Premium: { monthly: 999, yearly: 9590 }
    };

    // ----- Helpers -----
    function formatDate(d = new Date()) {
      return d.toLocaleDateString();
    }

    function displayPayments() {
      const body = document.getElementById('paymentTableBody');
      body.innerHTML = "";
      paymentHistory.forEach(p => {
        body.innerHTML += `
          <tr>
            <td>${p.id}</td>
            <td>${p.plan}</td>
            <td>‚Çπ${p.amount}</td>
            <td>${p.date}</td>
            <td>${p.status}</td>
          </tr>`;
      });
      document.getElementById('card-history-count').innerText = paymentHistory.length;
    }

    function renderSavedCards() {
      const ul = document.getElementById('savedCardsList');
      ul.innerHTML = '';
      if (savedCards.length === 0) {
        ul.innerHTML = '<li class="no-cards">No saved cards</li>';
      } else {
        savedCards.forEach((c, i) => {
          const li = document.createElement('li');
          li.innerHTML = `<div class="card-row">
            <div>
              <strong>**** **** **** ${c.last4}</strong>
              <div class="small">${c.name} ‚Ä¢ Expires ${c.expiry}</div>
            </div>
            <div>
              <button class="small-btn" onclick="removeCard(${i})">Remove</button>
            </div>
          </div>`;
          ul.appendChild(li);
        });
      }
      document.getElementById('card-saved-cards').innerText = savedCards.length;
    }

    function updateDashboardCards() {
      document.getElementById('card-plan').innerText = currentSubscription ? `${currentSubscription.plan} (${currentSubscription.type})` : 'No Active Plan';
      document.getElementById('card-next-bill').innerText = currentSubscription ? currentSubscription.renewal : '-';
      document.getElementById('card-history-count').innerText = paymentHistory.length;
      document.getElementById('card-saved-cards').innerText = savedCards.length;
    }

    function subscribePlan(planType) {
      const price = isYearly ? planPrices[planType].yearly : planPrices[planType].monthly;
      const type = isYearly ? "Yearly" : "Monthly";

      currentSubscription = {
        plan: planType,
        type,
        startDate: formatDate(),
        renewal: isYearly ? 'Next Year' : 'Next Month'
      };

      document.getElementById('subscriptionStatus').innerHTML = `
        <p><strong>Plan:</strong> ${currentSubscription.plan}</p>
        <p><strong>Type:</strong> ${currentSubscription.type}</p>
        <p><strong>Start Date:</strong> ${currentSubscription.startDate}</p>
        <p><strong>Renewal:</strong> ${currentSubscription.renewal}</p>
        <p style="color:green;"><strong>Your subscription is now active!</strong></p>
      `;

      paymentHistory.push({
        id: Math.floor(Math.random() * 900) + 100,
        plan: planType,
        amount: price,
        date: formatDate(),
        status: "Paid"
      });

      displayPayments();
      updateDashboardCards();
      showToast(`Subscribed to ${planType} (${type})`);
    }

    document.getElementById('togglePlan').addEventListener('change', function() {
      isYearly = this.checked;
      document.getElementById('basic-price').textContent = isYearly ? "‚Çπ4790/year" : "‚Çπ499/month";
      document.getElementById('pro-price').textContent = isYearly ? "‚Çπ7670/year" : "‚Çπ799/month";
      document.getElementById('premium-price').textContent = isYearly ? "‚Çπ9590/year" : "‚Çπ999/month";
    });

    document.getElementById('cardForm').addEventListener('submit', function(e) {
      e.preventDefault();
      const name = document.getElementById('cardName').value.trim();
      const number = document.getElementById('cardNumber').value.replace(/\s+/g, '');
      const expiry = document.getElementById('cardExpiry').value.trim();
      const cvv = document.getElementById('cardCvv').value.trim();

      if (!name || number.length < 12 || expiry.length < 4 || cvv.length < 3) {
        showToast('Please enter valid card details', true);
        return;
      }

      savedCards.push({
        name,
        last4: number.slice(-4),
        expiry
      });

      this.reset();
      renderSavedCards();
      updateDashboardCards();
      showToast('Card saved locally');
    });

    function removeCard(index) {
      savedCards.splice(index, 1);
      renderSavedCards();
      updateDashboardCards();
      showToast('Card removed');
    }

    document.querySelectorAll('.accordion-item').forEach(btn => {
      btn.addEventListener('click', () => {
        const expanded = btn.getAttribute('aria-expanded') === 'true';
        btn.setAttribute('aria-expanded', !expanded);
        const panel = btn.nextElementSibling;
        if (!expanded) {
          panel.style.maxHeight = panel.scrollHeight + 'px';
          btn.querySelector('.acc-icon').innerText = '‚àí';
        } else {
          panel.style.maxHeight = null;
          btn.querySelector('.acc-icon').innerText = '+';
        }
      });
    });

    const navLinks = document.querySelectorAll('.sidebar a');
    navLinks.forEach(a => {
      a.addEventListener('click', function(e) {
        e.preventDefault();
        const targetId = this.getAttribute('href').slice(1);
        const el = document.getElementById(targetId);
        if (el) el.scrollIntoView({ behavior: 'smooth', block: 'start' });
      });
    });

    const sections = document.querySelectorAll('main section');
    function onScroll() {
      const scTop = window.scrollY + 120;
      let currentId = sections[0].id;
      sections.forEach(section => {
        if (section.offsetTop <= scTop) currentId = section.id;
      });
      navLinks.forEach(link => {
        link.classList.toggle('active', link.getAttribute('href') === '#' + currentId);
      });
    }
    window.addEventListener('scroll', onScroll, { passive: true });
    window.addEventListener('resize', onScroll);
    onScroll();

    function showToast(msg, isError = false) {
      const t = document.createElement('div');
      t.className = 'page-toast' + (isError ? ' error' : '');
      t.innerText = msg;
      document.body.appendChild(t);
      setTimeout(() => t.classList.add('visible'), 20);
      setTimeout(() => { t.classList.remove('visible'); setTimeout(() => t.remove(), 400); }, 3000);
    }

    function init() {
      displayPayments();
      renderSavedCards();
      updateDashboardCards();
      document.querySelectorAll('.faqs-section .panel').forEach(p => p.style.maxHeight = null);
    }
    init();
  </script>
</body>
</html>
